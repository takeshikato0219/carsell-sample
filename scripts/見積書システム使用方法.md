# Katomo 見積書システム 使用方法

## ファイル構成

- `Katomo見積書システム.xlsx` - 見積書Excelファイル
- `見積書マクロ.bas` - VBAマクロファイル（インポート用）
- `create_estimate_excel.py` - Excel生成スクリプト

## セットアップ手順

### 1. Excelファイルを開く
`Katomo見積書システム.xlsx` をExcelで開きます。

### 2. VBAマクロをインポート

1. `Alt + F11` でVBAエディタを開く
2. メニューから「ファイル」→「ファイルのインポート」を選択
3. `見積書マクロ.bas` を選択してインポート
4. VBAエディタを閉じる

### 3. マクロ有効ブックとして保存

1. 「ファイル」→「名前を付けて保存」
2. ファイル形式を「Excelマクロ有効ブック (*.xlsm)」に変更
3. 保存

## 見積書の使い方

### シート構成

- **見積書シート**: 見積書の入力・印刷用
- **データシート**: 車両・オプションのマスタデータ

### 入力フロー

1. **見積番号の生成**
   - マクロ `GenerateEstimateNumber` を実行
   - または手動で見積日・見積番号を入力

2. **お客様情報の入力**
   - 黄色のセルに入力（お客様名、住所、電話番号）

3. **車両の選択**
   - C15セルのドロップダウンから車両を選択
   - 価格が自動で取得されます

4. **オプションの追加**
   - C18〜C37セルのドロップダウンからオプションを選択
   - D列に数量を入力
   - 価格が自動計算されます

5. **諸費用の調整**
   - 納車費用、下取り手数料は必要に応じて変更

6. **下取り・値引き**
   - 下取り車の情報、下取り価格、値引き額を入力

7. **備考欄**
   - 必要な備考を入力

### マクロ機能

| マクロ名 | 機能 |
|---------|------|
| `ClearEstimate` | 見積書の入力をクリア |
| `ExportToPDF` | PDFファイルとして出力 |
| `PrintPreview` | 印刷プレビュー表示 |
| `PrintEstimate` | 直接印刷 |
| `GenerateEstimateNumber` | 見積番号を自動生成 |

### マクロの実行方法

1. `Alt + F8` でマクロダイアログを開く
2. 実行したいマクロを選択
3. 「実行」をクリック

### ショートカットキーの割り当て（オプション）

1. `Alt + F8` でマクロダイアログを開く
2. マクロを選択して「オプション」をクリック
3. ショートカットキーを設定

推奨設定:
- `Ctrl + Shift + C` → ClearEstimate
- `Ctrl + Shift + P` → ExportToPDF

## データの更新

### 車両データの追加

1. データシートを開く
2. 車両マスタテーブルに新しい行を追加
3. 車両名、ベース車、駆動、排気量、燃料、販売価格、税金情報を入力

### オプションデータの追加

1. データシートを開く
2. オプションマスタテーブルに新しい行を追加
3. コード、オプション名、カテゴリ、価格を入力

## 印刷設定

- A4縦向き
- 1ページに収まるように設定済み
- 余白: 上下左右 0.5インチ

## トラブルシューティング

### マクロが実行できない
- マクロを有効にする設定を確認
- ファイル → オプション → セキュリティセンター → 「すべてのマクロを有効にする」

### 価格が表示されない
- 車両名/オプション名が完全に一致しているか確認
- データシートにデータが存在するか確認

### 印刷がずれる
- 印刷プレビューで確認
- ページ設定を確認（A4、縦向き、1ページ）
