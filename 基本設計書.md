# Katomo 営業支援ツール - 基本設計書

## 1. システム概要

自動車販売営業を効率化するための統合管理システム。
顧客管理、営業進捗管理、目標管理を一元化し、紙ベースの情報をデジタル化して営業活動を支援する。

## 2. 主要機能

### 2.1 顧客管理機能

#### 2.1.1 顧客情報取得
- **紙媒体スキャン機能**
  - アンケート用紙のスキャン・OCR読み取り
  - 電話メモのスキャン・OCR読み取り
  - 画像アップロード機能
  - OCRによる自動テキスト化
  - 手動補正・編集機能

#### 2.1.2 顧客情報管理
- 顧客基本情報（氏名、連絡先、住所等）
- 商談履歴・メモ
- 音声ファイルアップロード機能
- 営業メモアップロード機能
- 前回商談内容の参照
- 顧客ごとのタイムライン表示

#### 2.1.3 見積もり管理
- Excelファイルアップロード機能
- 顧客と見積もりの紐付け
- 見積もり履歴管理
- 見積もり状態管理（検討中、承認、却下等）

#### 2.1.4 コミュニケーション支援
- **定期連絡管理**
  - 電話連絡スケジュール設定
  - 連絡履歴記録
  - リマインダー機能

- **メール自動作成・送信**
  - AI による過去商談内容を基にしたメール文面生成
  - 前回のやり取りを考慮したパーソナライズ
  - メール送信機能（直接送信または下書き作成）
  - 送信履歴管理

### 2.2 営業進捗管理機能（看板方式）

#### 2.2.1 カンバンボード
- **ステージ管理**
  - 初回接触
  - ヒアリング
  - 見積もり提示
  - 商談中
  - 契約手続き
  - 納車待ち
  - 納車済み
  - 失注

- **カード機能**
  - ドラッグ&ドロップでステージ移動
  - 顧客情報サマリー表示
  - 優先度設定
  - 担当営業割り当て
  - 期限設定

#### 2.2.2 Notion風メモ機能
- マークダウン対応
- リッチテキストエディタ
- チェックリスト
- 画像・ファイル添付
- タグ付け機能
- 検索機能

### 2.3 営業目標管理機能

#### 2.3.1 契約・原価管理
- **Excelアップロード機能**
  - 契約情報の自動読み取り
  - 原価情報の取り込み
  - 利益率自動計算

#### 2.3.2 目標管理ダッシュボード
- **現状把握**
  - 現在の契約台数
  - 販売価格の平均・合計
  - 利益率の表示
  - 月次・四半期・年次での集計

- **目標設定・追跡**
  - 個人目標設定
  - チーム目標設定
  - 達成率の可視化
  - 進捗グラフ表示

#### 2.3.3 バックオーダー管理
- 受注済み・納車待ち台数管理
- 納車予定日管理
- 遅延アラート機能
- 在庫状況連携（将来的）

### 2.4 納車前後管理機能

#### 2.4.1 納車前顧客コンタクト
- 納車予定日カウントダウン
- 定期連絡スケジュール
- 進捗状況共有
- 必要書類リマインダー

#### 2.4.2 納車後フォロー
- 納車日記録
- アフターフォロースケジュール
- 満足度調査
- 次回商談機会の創出

## 3. システムアーキテクチャ

### 3.1 構成概要

```
┌─────────────────┐
│  フロントエンド  │  Next.js + React
│  (Web UI)       │  Tailwind CSS
└────────┬────────┘
         │
         │ REST API / GraphQL
         │
┌────────┴────────┐
│  バックエンド    │  Node.js + Express/NestJS
│  (API Server)   │  または Python + FastAPI
└────────┬────────┘
         │
    ┌────┴─────┬──────────┬──────────┐
    │          │          │          │
┌───┴───┐ ┌───┴───┐ ┌───┴───┐ ┌───┴────┐
│ DB    │ │ OCR   │ │ AI    │ │ Storage│
│Postgres│ │Engine │ │Service│ │ S3/R2  │
└───────┘ └───────┘ └───────┘ └────────┘
```

### 3.2 技術スタック（推奨）

#### フロントエンド
- **フレームワーク**: Next.js 14+ (App Router)
- **言語**: TypeScript
- **UI**: Tailwind CSS + shadcn/ui
- **状態管理**: Zustand または Jotai
- **カンバンUI**: @dnd-kit または react-beautiful-dnd
- **リッチテキスト**: Tiptap または Novel

#### バックエンド
- **フレームワーク**: NestJS (TypeScript) または FastAPI (Python)
- **API**: RESTful + GraphQL (Apollo)
- **認証**: NextAuth.js または Auth0

#### データベース
- **メインDB**: PostgreSQL
- **キャッシュ**: Redis
- **ファイルストレージ**: AWS S3 / Cloudflare R2 / MinIO

#### AI・機能連携
- **OCR**: Tesseract OCR / Google Cloud Vision API / AWS Textract
- **AI文章生成**: OpenAI GPT-4 / Anthropic Claude API
- **メール送信**: SendGrid / Resend

#### インフラ
- **ホスティング**: Vercel (フロント) + AWS/GCP/Railway (バック)
- **CI/CD**: GitHub Actions
- **監視**: Sentry + Vercel Analytics

## 4. データベース設計（概要）

### 4.1 主要テーブル

#### customers (顧客)
- id, name, email, phone, address
- created_at, updated_at
- assigned_sales_rep_id

#### contacts (コンタクト履歴)
- id, customer_id, contact_type (電話/メール/訪問)
- content, audio_file_url, memo_file_url
- contacted_at, created_by

#### quotes (見積もり)
- id, customer_id, quote_number
- excel_file_url, amount, status
- created_at, valid_until

#### deals (商談・案件)
- id, customer_id, stage
- priority, assigned_to, deadline
- created_at, updated_at

#### contracts (契約)
- id, deal_id, customer_id
- contract_amount, cost, profit_margin
- contract_date, delivery_date
- status (納車待ち/納車済み)

#### sales_targets (営業目標)
- id, user_id, period (月次/四半期/年次)
- target_units, target_revenue
- actual_units, actual_revenue

#### notes (メモ・ノート)
- id, related_type (customer/deal/contract)
- related_id, content (JSON)
- created_by, created_at

#### users (ユーザー・営業担当)
- id, name, email, role
- created_at

## 5. 画面構成

### 5.1 主要画面
1. **ダッシュボード**: 目標達成状況、重要タスク、アラート
2. **顧客一覧**: 検索・フィルタ機能付き顧客リスト
3. **顧客詳細**: 顧客情報、履歴、見積もり、メモ
4. **スキャン取り込み**: 画像アップロード・OCR処理・編集
5. **カンバンボード**: 営業進捗の可視化・管理
6. **目標管理**: 個人・チーム目標、達成率、グラフ
7. **バックオーダー**: 納車待ち案件一覧
8. **設定**: ユーザー管理、システム設定

## 6. セキュリティ・権限管理

### 6.1 ユーザーロール
- **管理者**: 全機能アクセス、ユーザー管理
- **営業マネージャー**: チーム全体の閲覧・編集、目標設定
- **営業担当**: 自分の顧客の管理、閲覧

### 6.2 セキュリティ対策
- JWT認証
- HTTPS通信
- データ暗号化（保存時・通信時）
- ファイルアップロードの検証・サニタイズ
- APIレート制限

## 7. 開発フェーズ（推奨）

### Phase 1: MVP（最小限の機能）
- 顧客管理基本機能
- 簡易カンバンボード
- 基本的な目標管理

### Phase 2: コア機能
- OCRスキャン機能
- 見積もり管理
- メモ機能強化

### Phase 3: AI・自動化
- AIメール生成
- 自動リマインダー
- 音声メモ文字起こし

### Phase 4: 高度な機能
- 詳細な分析・レポート
- モバイルアプリ
- 外部システム連携

## 8. 非機能要件

- **パフォーマンス**: ページ読み込み3秒以内
- **可用性**: 99.5%以上
- **スケーラビリティ**: 同時ユーザー100名対応
- **バックアップ**: 日次自動バックアップ
- **データ保持**: 最低3年間

## 9. 今後の検討事項

- モバイルアプリの必要性
- オフライン対応
- 他システム（会計、在庫管理）との連携
- LINE/Slack等の外部ツール連携
- 音声入力・音声文字起こし精度
- マルチテナント対応（複数店舗展開時）
